<mat-spinner *ngIf="isLoading"></mat-spinner>

<form
  (submit)="onSaveEvent(eventForm)"
  #eventForm="ngForm"
  *ngIf="!isLoading">
  <h4>Event Information</h4>

  <mat-form-field class="fieldCompanyName">
    <mat-select
      placeholder="Company Name"
      name="companyName"
      #companyName="ngModel"
      [ngModel]="event?.companyName">
      <mat-option
        *ngFor="let company of companies"
        [value]="company.companyName">
        {{ company.companyName }}
      </mat-option>
    </mat-select>
    <mat-error
      *ngIf="eventForm.invalid">
      Please select a company
    </mat-error>
  </mat-form-field>

  <mat-form-field
    class="fieldEventType">
    <mat-select
      placeholder="Event Type"
      name="eventType"
      #eventType="ngModel"
      [ngModel]="event?.eventType"
      [(value)]="selectedEventType">
      <mat-option
        *ngFor="let eventType of eventTypes"
        [value]="eventType" >
        {{ eventType }}
      </mat-option>
    </mat-select>
    <mat-error
      *ngIf="eventForm.invalid">
      Please select an event type
    </mat-error>
  </mat-form-field>

  <mat-form-field class="fieldExpirationDate" *ngIf="selected != 'None'">
    <input
      matInput
      [matDatepicker]="picker"
      placeholder="Event Date"
      name="certExpirationDate"
      #certExpirationDate="ngModel"
      [ngModel]="company?.certification.expirationDate" required>
    <mat-datepicker-toggle
      matSuffix
      [for]="picker" required></mat-datepicker-toggle>
    <mat-datepicker touchUi="true" #picker></mat-datepicker>
  </mat-form-field>

  <div>
    <mat-form-field class="fieldtlPartNumber">
      <input
        matInput
        placeholder="T&L Part Number"
        name="tlPartNumber"
        #tlPartNumber="ngModel"
        [ngModel]="company?.companyAddress.street1"
        required>
      <mat-error *ngIf="eventForm.invalid">Please enter a T&L Part Number</mat-error>
    </mat-form-field>
    <!--<br>-->
    <mat-form-field class="fieldPurchaseOrderNumber">
      <input
        matInput
        placeholder="Purchase Order Number "
        name="purchaseOrderNumber"
        #purchaseOrderNumber="ngModel"
        [ngModel]="company?.companyAddress.street2">
    </mat-form-field>
    <br>
    <mat-form-field class="fieldLotNumber">
      <input
        matInput
        placeholder="Lot Number"
        name="lotNumber"
        #lotNumber="ngModel"
        [ngModel]="company?.companyAddress.city"
        required>
      <mat-error *ngIf="eventForm.invalid">Please enter a Lot Number</mat-error>
    </mat-form-field>
    <!--<br>-->
    <mat-form-field class="fieldCarNumber">
      <input
        matInput
        placeholder="CAR Number"
        name="carNumber"
        #carNumber="ngModel"
        [ngModel]="company?.companyAddress.zipcode"
        required>
      <mat-error *ngIf="eventForm.invalid">Please enter a CAR Number</mat-error>
    </mat-form-field>
    <br>
    <mat-form-field class="fieldQuantityReject" *ngIf="selectedEventType == 'Quality'">
      <input
        matInput
        type="number"
        placeholder="Quantity Rejected"
        name="quantityReject"
        #quantityReject="ngModel"
        [ngModel]="event?.quantityReject"
        required>
      <mat-error *ngIf="eventForm.invalid">Please enter the rejected quantity</mat-error>
    </mat-form-field>

    <mat-form-field class="fieldRequiredDate" *ngIf="selectedEventType == 'Delivery'">
      <input
        matInput
        [matDatepicker]="picker"
        placeholder="Required Delivery Date"
        name="certExpirationDate"
        #certExpirationDate="ngModel"
        [ngModel]="company?.certification.expirationDate" required>
      <mat-datepicker-toggle
        matSuffix
        [for]="picker" required></mat-datepicker-toggle>
      <mat-datepicker touchUi="true" #picker></mat-datepicker>
      <mat-error *ngIf="eventForm.invalid">Please enter a required delivery date</mat-error>
    </mat-form-field>

    <mat-form-field class="fieldActualDate" *ngIf="selectedEventType == 'Delivery'">
      <input
        matInput
        [matDatepicker]="picker"
        placeholder="Actual Delivery Date"
        name="certExpirationDate"
        #certExpirationDate="ngModel"
        [ngModel]="company?.certification.expirationDate" required>
      <mat-datepicker-toggle
        matSuffix
        [for]="picker" required></mat-datepicker-toggle>
      <mat-datepicker touchUi="true" #picker></mat-datepicker>
      <mat-error *ngIf="eventForm.invalid">Please enter the actual delivery date</mat-error>
    </mat-form-field>

    <mat-form-field class="fieldRootCause">
      <textarea
        matInput
        placeholder="Root Cause"
        name="rootCause"
        #rootCause="ngModel"
        [ngModel]="company?.companyAddress.zipcode"
        required></textarea>
      <mat-error *ngIf="eventForm.invalid">Please enter a root cause</mat-error>
    </mat-form-field>
  </div>


  <hr>
  <button
    mat-raised-button
    type="reset"
    color="warn">
    Cancel
  </button>
  <button class="submitButton"
          mat-raised-button
          type="submit"
          color="primary" >
    Save Company
  </button>
</form>

